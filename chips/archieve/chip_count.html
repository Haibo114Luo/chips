<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>德州扑克计分器</title>
  <style>
    /* 基础样式 */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      position: relative;
      background-color: #333;
      color: #fff;
      padding: 10px;
      text-align: center;
    }
    /* 菜单按钮（依然保留） */
    .menu-btn {
      position: absolute;
      left: 10px;
      top: 10px;
      background: none;
      border: none;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
    }
    /* 顶部金额显示：居中显示 */
    .amount-display {
      font-size: 24px;
      cursor: pointer;
      transition: transform 0.2s;
      display: inline-block;
    }
    .amount-display.enlarged {
      transform: scale(1.5);
    }
    /* 侧边菜单：默认隐藏且不占用屏幕 */
    .side-menu {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #444;
      color: #fff;
      overflow-y: auto;
      transition: left 0.3s;
      z-index: 100;
      padding: 10px;
    }
    .side-menu.active {
      left: 0;
    }
    .side-menu img {
      width: 100%;
      height: auto;
      margin-bottom: 10px;
    }
    .side-menu p {
      margin: 0;
    }
    /* 主体部分 */
    main {
      flex: 1;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-y: auto;
    }
    .hidden {
      display: none;
    }
    .section {
      width: 100%;
      max-width: 500px;
      background: #fff;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 15px;
    }
    .section input {
      width: 100%;
      padding: 8px;
      margin: 5px 0 10px;
      box-sizing: border-box;
    }
    .section button {
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }
    /* 累计下注值显示，加大字号 */
    .bet-container {
      text-align: center;
      margin: 20px 0;
    }
    .bet-display {
      font-size: 72px;
      margin-bottom: 10px;
    }
    .bet-display .last-input {
      font-size: 60px;
      color: #666;
      margin-left: 5px;
    }
    /* 自定义软键盘 */
    .soft-keyboard {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 5px;
      margin-bottom: 15px;
    }
    .soft-keyboard button {
      padding: 15px;
      font-size: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background: #eee;
      cursor: pointer;
    }
    /* 计算器操作区：使用flex布局 */
    .calc-ops {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
    }
    /* btnAdd 占位1.5倍，重置按钮占1 */
    #btnAdd {
      flex: 1.5;
      font-size: 20px;
      padding: 15px;
    }
    #btnResetCalc {
      flex: 1;
      font-size: 18px;
      padding: 10px 15px;
    }
    /* 底部赢输按钮 */
    .bottom-btns {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 500px;
    }
    .bottom-btns button {
      flex: 1;
      margin: 0 5px;
      padding: 15px;
      font-size: 20px;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .btn-win {
      background-color: green;
    }
    .btn-lose {
      background-color: red;
    }
  </style>
</head>
<body>
  <!-- 侧边菜单 -->
  <div class="side-menu" id="sideMenu">
    <button class="menu-btn" id="closeMenu" style="position:absolute; right:10px; top:10px;">✖</button>
    <h3>Rule</h3>
    <!-- 图片引用同目录下的本地文件 -->
    <img src="rule.jpg" alt="菜单图片">
    <p>右上角有个看不见的x可以关掉</p>
  </div>

  <header>
    <button class="menu-btn" id="openMenu">☰</button>
    <!-- 当前金额居中显示 -->
    <div id="amountDisplay" class="amount-display">0</div>
  </header>

  <main>
    <!-- 设置起始金额 -->
    <div class="section" id="setupSection">
      <h2>设置起始金额</h2>
      <input type="number" id="startAmountInput" placeholder="请输入起始金额" required>
      <button id="btnSetup">开始游戏</button>
    </div>

    <!-- 游戏界面 -->
    <div class="section hidden" id="gameSection">
      <!-- 累计下注值显示 -->
      <div class="bet-container">
        <div class="bet-display" id="betDisplay">0<span class="last-input">(0)</span></div>
      </div>
      <!-- 自定义软键盘显示当前输入值 -->
      <div class="section" style="padding:10px; text-align:center;">
        <div id="calcInputDisplay" style="font-size:28px; margin-bottom:10px;">0</div>
        <div class="soft-keyboard" id="softKeyboard">
          <!-- 第一行 -->
          <button data-value="1">1</button>
          <button data-value="2">2</button>
          <button data-value="3">3</button>
          <!-- 第二行 -->
          <button data-value="4">4</button>
          <button data-value="5">5</button>
          <button data-value="6">6</button>
          <!-- 第三行 -->
          <button data-value="7">7</button>
          <button data-value="8">8</button>
          <button data-value="9">9</button>
          <!-- 第四行 -->
          <button data-action="clear">清除</button>
          <button data-value="0">0</button>
          <button data-value=".">.</button>
        </div>
      </div>
      <!-- 计算器操作区（仅加和重置） -->
      <div class="calc-ops">
        <button id="btnAdd">+</button>
        <button id="btnResetCalc">Re</button>
      </div>
      <!-- 底部赢输按钮 -->
      <div class="bottom-btns">
        <button class="btn-lose" id="btnLose">输</button>
        <button class="btn-win" id="btnWin">赢</button>
      </div>
    </div>
  </main>

  <script>
    // 全局变量
    let startAmount = 0;
    let currentAmount = 0;
    let currentBet = 0;
    let currentInput = ""; // 软键盘输入的字符串
    let lastInput = 0; // 上次加入累计值的数字

    // DOM元素
    const setupSection = document.getElementById('setupSection');
    const gameSection = document.getElementById('gameSection');
    const startAmountInput = document.getElementById('startAmountInput');
    const btnSetup = document.getElementById('btnSetup');
    const amountDisplay = document.getElementById('amountDisplay');
    const betDisplay = document.getElementById('betDisplay');
    const calcInputDisplay = document.getElementById('calcInputDisplay');
    const softKeyboard = document.getElementById('softKeyboard');
    const btnAdd = document.getElementById('btnAdd');
    const btnResetCalc = document.getElementById('btnResetCalc');
    const btnWin = document.getElementById('btnWin');
    const btnLose = document.getElementById('btnLose');
    const openMenu = document.getElementById('openMenu');
    const closeMenu = document.getElementById('closeMenu');
    const sideMenu = document.getElementById('sideMenu');

    // 侧边菜单控制
    openMenu.addEventListener('click', () => {
      sideMenu.classList.add('active');
    });
    closeMenu.addEventListener('click', () => {
      sideMenu.classList.remove('active');
    });

    // 设置起始金额并开始游戏
    btnSetup.addEventListener('click', () => {
      const amt = parseFloat(startAmountInput.value);
      if(isNaN(amt)) {
        alert("请输入有效的起始金额！");
        return;
      }
      startAmount = amt;
      currentAmount = amt;
      updateAmountDisplay();
      // 隐藏设置区域，显示游戏界面
      setupSection.classList.add('hidden');
      gameSection.classList.remove('hidden');
    });

    // 更新顶部显示的金额（整数显示）
    function updateAmountDisplay(){
      amountDisplay.textContent = `${Math.round(currentAmount)}`;
    }

    // 点击顶部金额放大显示
    amountDisplay.addEventListener('click', () => {
      amountDisplay.classList.toggle('enlarged');
      setTimeout(() => {
        amountDisplay.classList.remove('enlarged');
      }, 800);
    });

    // 软键盘事件处理
    softKeyboard.addEventListener('click', (e) => {
      if(e.target.tagName.toLowerCase() !== "button") return;
      const btn = e.target;
      const value = btn.getAttribute('data-value');
      const action = btn.getAttribute('data-action');
      if(action === "clear") {
        currentInput = "";
      } else if(value) {
        if(value === "." && currentInput.includes(".")) return;
        currentInput += value;
      }
      updateCalcInputDisplay();
    });

    // 更新软键盘输入显示
    function updateCalcInputDisplay(){
      calcInputDisplay.textContent = currentInput === "" ? "0" : currentInput;
    }

    // 加操作，使用软键盘输入的数字
    btnAdd.addEventListener('click', () => {
      const val = parseFloat(currentInput);
      if(!isNaN(val)) {
        currentBet += val;
        lastInput = val;
        updateBetDisplay();
      }
      currentInput = "";
      updateCalcInputDisplay();
    });
    // 重置操作
    btnResetCalc.addEventListener('click', () => {
      currentBet = 0;
      lastInput = 0;
      updateBetDisplay();
    });

    function updateBetDisplay(){
      // 显示整数，旁边显示上次输入（括号内）
      betDisplay.innerHTML = `<span class="main-bet">${Math.round(currentBet)}</span><span class="last-input">(${Math.round(lastInput)})</span>`;
    }

    // 赢输按钮更新金额
    btnWin.addEventListener('click', () => {
      currentAmount += currentBet;
      resetBet();
      updateAmountDisplay();
    });
    btnLose.addEventListener('click', () => {
      currentAmount -= currentBet;
      resetBet();
      updateAmountDisplay();
    });
    function resetBet(){
      currentBet = 0;
      lastInput = 0;
      updateBetDisplay();
    }
  </script>
</body>
</html>
